<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="utf-8">
<title>canvas1</title>
<style type="text/css">
  canvas {
    border: 1px solid black;
    width:  240px;
    height: 240px;
  }

  div#widget {
    text-align: center;
  }

  div#widget table {
    margin-left: auto;
    margin-right: auto;
  }

  span.view {
    float: right;
    width: 40px;
  }
</style>

<script type="text/javascript">
  function findCrossing (foo, i, j) {
    var a1 = foo(i-1, j-1);
    var a2 = foo(i+1, j-1);
    var a3 = foo(i-1, j+1);
    var a4 = foo(i+1, j+1);
    return (a1*a2 < 0) || (a1*a3 < 0) || (a1*a4 < 0);
  }

  /* Cribbed from hacks.mozilla.org */
  function plotEquation(fun) {
    var canvas = document.getElementById('win');
    var xDim = canvas.width;
    var yDim = canvas.height;
    var ctx = canvas.getContext('2d');
    var imageData = ctx.getImageData(0, 0, xDim, yDim);
    var data = imageData.data;

    var xSemiDim = xDim / 2;
    var ySemiDim = yDim / 2;

    for (var y = 0; y < yDim; y++) {
      for (var x = 0; x < xDim; x++) {
        if (findCrossing(fun, x - xSemiDim, ySemiDim - y)) {
          var index = (y * xDim + x) * 4;
          data[index]   = 0;   // red
          data[++index] = 0;   // green
          data[++index] = 0;   // blue
          data[++index] = 255; // alpha
        }
      }
    }

    ctx.putImageData(imageData, 0, 0);
  };

  function reset() {
    document.getElementById('aSlider').value = 1;
    document.getElementById('bSlider').value = 1;
    document.getElementById('hSlider').value = 0;
    document.getElementById('kSlider').value = 0;
    draw();
    return;
  };

  function draw() {
    var canvas = document.getElementById('win');
    var ctx = canvas.getContext('2d');
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    var a = document.getElementById('aSlider').value;
    var b = document.getElementById('bSlider').value;
    var h = document.getElementById('hSlider').value;
    var k = document.getElementById('kSlider').value;

    document.getElementById('aView').innerHTML = a;
    document.getElementById('bView').innerHTML = b;
    document.getElementById('hView').innerHTML = h;
    document.getElementById('kView').innerHTML = k;

    var primLine = function (x,y) { return y - x; };
    var primCirc = function (x,y) { return x*x + y*y - 1; };
    var primElli = function (x,y) { return y*y - x*x*x + 2*x; };
    var primQuad = function (x,y) { return y - x*x; };
    var primCube = function (x,y) { return y - x*x*x + x; };
    var primEll2 = function (x,y) { return y*y - x*x*x + 2*x - 2; };

    var primAmpr = function (x,y) {
      return (y*y - x*x)*(x-1)*(2*x-3) - 4*(x*x + y*y - 2*x)*(x*x + y*y - 2*x);
    };

    var circ = function(x,y) {
      return primCirc((x-h)/(a*15), (y-k)/(b*15));
    }

    var line = function(x,y) {
      return primLine((x-h)/(a*15), (y-k)/(b*15));
    }

    var elli = function(x,y) {
      return primElli((x-h)/(a*15), (y-k)/(b*15));
    }

    var quad = function(x,y) {
      return primQuad((x-h)/(a*15), (y-k)/(b*15));
    }

    var cube = function(x,y) {
      return primCube((x-h)/(a*15), (y-k)/(b*15));
    }

    var ell2 = function(x,y) {
      return primEll2((x-h)/(a*15), (y-k)/(b*15));
    }

    var ampr = function(x,y) {
      return primAmpr((x-h)/(a*15), (y-k)/(b*15));
    }

    var selection = document.getElementById('equation-type').value;

    switch (selection) {
      case 'circle':
        plotEquation(circ);
        break;
      case 'line':
        plotEquation(line);
        break;
      case 'elliptic':
        plotEquation(elli);
        break;
      case 'quadratic':
        plotEquation(quad);
        break;
      case 'cubic':
        plotEquation(cube);
        break;
      case 'elliptic2':
        plotEquation(ell2);
        break;
      case 'ampersand':
        plotEquation(ampr);
        break;
    }
  };
</script>
</head>



<body onload="draw();">
<div id="widget">
<canvas id="win" width="180" height="180"></canvas>

<table>
<tr><td>a = <span id="aView" class="view"></span></td>
  <td><input id="aSlider" type="range" max="3" min="-1" step="0.02" oninput="draw();" /></td>
</tr>

<tr><td>b = <span id="bView" class="view"></span></td>
  <td><input id="bSlider" type="range" max="3" min="-1" step="0.02" oninput="draw();" /></td>
</tr>

<tr><td>h = <span id="hView" class="view"></span></td>
  <td><input id="hSlider" type="range" max="160" min="-160" step="1" oninput="draw();" /></td>
</tr>

<tr><td>k = <span id="kView" class="view"></span></td>
  <td><input id="kSlider" type="range" max="120" min="-120" step="1" oninput="draw();" /></td>
</tr>
</table>

<div>
Equation Type: <select id="equation-type" onclick="draw();">
  <option value="circle">Circle</option>
  <option value="line">Line</option>
  <option value="quadratic">Quadratic</option>
  <option value="cubic">Cubic</option>
  <option value="elliptic">Elliptic</option>
  <option value="elliptic2">Elliptic 2</option>
  <option value="ampersand">Ampersand</option>
</select>
</div>

<div>
<button type="button" onclick="reset();">Reset</button>
</div>
</div>
</body>
</html>